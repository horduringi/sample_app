<% provide(:title, "Medical abstraction form") %> 
<div class="row-fluid">
  <p style="text-align:left; color:red; font-size:1.2em; padding-top:10px">ALiCCS - Adult Life after Childhood Cancer in Scandinavia</p>
</div>
<div class="row-fluid">
  <div class="span7">
    <h1 style="text-align:left">Medical abstraction form</h1>
  </div>
  <div class="span5">
    <br>
    <p class="infoSmall">Danish Cancer Society Research Center<br>
      Strandboulevarden 49, 2100 Copenhagen, DK<br>
      <b>Contact:</b><br>
      Thorgerdur Gudmundsdottir, thorgud@cancer.dk, +45 35257648<br>
      Thomas Wiebe, thomas.wiebe@skane.se, +46 46178284</p>
  </div>
</div>
<br><br>
 
<div ng-controller="FormCtrl" ng-app="formApp">
  <%= form_for(@journal) do |j| %>
  <div class="row-fluid">
    <div class="span3">     
        <p>Country:</p>
    </div>
    <div class="span2">
      <%- if @journal.country %>
      <%= Country.find(@journal.country).countryname %>
      <%- else %>
      <%= "Undefined" %>
      <%- end %>
    </div>
  </div>
  <div class="row-fluid">
    <div class="span3">     
        <p><b>Patient ALiCCS-study no.:</b></p>
    </div>
    <div class="span2">
        <%= @journal.studynumber %>
    </div>
  </div>
  <br>
  <div class="row-fluid">
    <div class="span3">     
        <p>Gender:</p>
    </div>
    <div class="span2">
        <%= j.select :gender, options_from_collection_for_select(Gender.all, :id, :gender_combo, @journal.gender), {}, {"ng-model" => "journal.gender"} %>
    </div>
  </div>
  <br>
  <div class="row-fluid">
    <div class="span3">
      <p>Comments:</p>
    </div>
    <div class="span9">
      <%= j.text_area :comments, :cols => "30", :rows => "7" %> 
    </div>     
  </div>
  <br>
        <p>Any missing information concerning different aspects of the childhood cancer treatment?</p>
  <div class="row-fluid">
    <div class="span3"> 
      <p>Chemotherapy?</p>
    </div>
    <div class="span5"> 
        <%= j.select :missinginfochemo, options_from_collection_for_select(MissingInfo.all, :id, :missingInfo_combo, @journal.missinginfochemo), {}, {"ng-model" => "journal.missinginfochemo"} %>
    </div>
  </div>
  <div class="row-fluid">
    <div class="span3">
        <p>Radiotherapy?</p>
    </div>
    <div class="span5"> 
        <%= j.select :missinginforadio, options_from_collection_for_select(MissingInfo.all, :id, :missingInfo_combo, @journal.missinginforadio), {}, {"ng-model" => "journal.missinginforadio"} %>     
    </div>
  </div>
  <div class="row-fluid">
    <div class="span3">
        <p>Surgery?</p>
    </div>
    <div class="span5"> 
        <%= j.select :missinginfosurgery, options_from_collection_for_select(MissingInfo.all, :id,:missingInfo_combo, @journal.missinginfosurgery), {}, {"ng-model" => "journal.missinginfosurgery"} %>
    </div>
  </div>
  <br>
  <div class="row-fluid">
    <div class="span3">
        <p>Radiotherapy records copied**:</p>
    </div>
    <div class="span6">
        <%= j.date_select :radiorecordscopied, {:start_year => 2013, :end_year => Time.now.year, :default => @journal.radiorecordscopied, order: [:day, :month, :year], include_blank: true}, {:class => "date_generic"}%>
    </div>
    <div class="span7 offset3">
        <p class="infoSmall">**copied WITHOUT any personal identifications. Leave empty if not relevant.</p>
    </div>
  </div>
  <br>
  <div class="row-fluid">
    <div class="span3">
      <p>Data extraction accomplished by:</p>
    </div>
    <div class="span8">
      <%= j.select :user_id, options_from_collection_for_select([current_user], :id,:name, current_user.id) %>
    </div>
  </div>
  <br>
  <div class="row-fluid">
    <div class="span3">
        <p>Date of extraction:</p>
    </div>
    <div class="span6">
        <%= j.date_select :dateofextraction, {:start_year => 2013, :end_year => Time.now.year, :default => @journal.dateofextraction, order: [:day, :month, :year]}, {:class => "date_generic"} %>
    </div>
  </div>
  <br>
  <br>
  <h2>Before the childhood cancer diagnosis</h2>
  <div class="row-fluid">
    <div class="span3">
        <p>Chronic diseases of importance before cancer diagnosis*:</p>
    </div>
    <div class="span5">
        <%= j.select :chronicdisease, options_from_collection_for_select(ChronicDisease.all, :id,:chronicdisease_combo, @journal.chronicdisease), {},  {"ng-model" => "journal.chronicdisease"} %>
    </div>
    <div class="span4">
      <p class="infoSmall">*See instructions for examples</p>
    </div>
  </div>
  <div class="row-fluid" ng-show="journal.chronicdisease == '2' || journal.chronicdisease == '3' || journal.chronicdisease == '4' || journal.chronicdisease == '5'">
    <div class="span3">
        <p>If yes, please specify*:
    </div>
    <div class="span9">
        <%= j.text_area :chronicdiseasespec, :cols => "30", :rows => "7" %>
    </div>
  </div>
  <div class="row-fluid">
    <div class="span3">
        <p>Chromosomal disorder:</p>
    </div>
    <div class="span5">
        <%= j.select :chromosomaldisorder, options_from_collection_for_select(ChromosomalDisorder.all, :id,:chromosomaldisorder_combo, @journal.chromosomaldisorder), {}, {"ng-model" => "journal.chromosomaldisorder"}%> 
    </div>
    <div class="span4">
      <p class="infoSmall">*See instructions (and appendix III) for examples</p>
    </div>
  </div>
  <div class="row-fluid" ng-show="journal.chromosomaldisorder=='3'">
    <div class="span3">
        <p>If yes, other than Down's syndrome, please specify*:
    </div>
    <div class="span9">
        <%= j.text_area :chromosomaldisorderspec, :cols => "30", :rows => "7" %>
    </div>
  </div>
  <div class="row-fluid">
    <div class="span3">
        <p>Immune deficiency</p>
    </div>
    <div class="span2">
        <%= j.select :immunedeficiency, options_from_collection_for_select(NoYes.all, :id,:noyes_combo, @journal.immunedeficiency), {}, {"ng-model" => "journal.immunedeficiency"} %> 
    </div>
  </div>
  <div class="row-fluid">
    <div class="span3">
        <p>Congenital anomaly</p>
    </div>
    <div class="span2">
        <%= j.select :congenitalanomaly, options_from_collection_for_select(NoYes.all, :id,:noyes_combo, @journal.congenitalanomaly), {}, {"ng-model" => "journal.congenitalanomaly"} %> 
    </div>
  </div>
  <div class="row-fluid">
    <div class="span3">
        <p>Neurofibromatosis</p>
    </div>
    <div class="span2">
        <%= j.select :neurofibromatosis, options_from_collection_for_select(NoYes.all, :id,:noyes_combo, @journal.neurofibromatosis), {}, {"ng-model" => "journal.neurofibromatosis"} %> 
    </div>
  </div>
  <div class="row-fluid">
    <div class="span3">
        <p>Other familial cancer syndromes</p>
    </div>
    <div class="span2">
        <%= j.select :otherfamilialcancersynd, options_from_collection_for_select(NoYes.all, :id,:noyes_combo, @journal.otherfamilialcancersynd), {}, {"ng-model" => "journal.otherfamilialcancersynd"}%> 
    </div>
  </div>
  <div class="row-fluid" ng-show="journal.otherfamilialcancersynd=='2'">
    <div class="span3">
        <p>If yes, please specify*:
    </div>
    <div class="span9">
        <%= j.text_area :otherfamilialcancersyndspec, :cols => "30", :rows => "7" %>
    </div>
  </div>
  <div class="row-fluid" ng-show="journal.otherfamilialcancersynd=='2'">
    <div class="span4 offset3">
      <p class="infoSmall">*See instructions for examples</p>
    </div>
  </div>
  <br>
  <div class="row-fluid">
    <div class="span3">
        <p>Cancer in the family, in a first-degree relative**</p>
    </div>
    <div class="span2">
        <%= j.select :cancerinfamily, options_from_collection_for_select(NoYesUnknown.all, :id,:noyesunknown_combo, @journal.cancerinfamily), {}, {"ng-model" => "journal.cancerinfamily"}%> 
    </div>
    <div class="span7">
      <p class="infoSmall">**First-degree relative = parents, siblings or possible offspring of the childhood cancer patient.</p>
    </div>
  </div>
  <div class="row-fluid" ng-show="journal.cancerinfamily=='2'">
    <div class="span3">
        <p>If yes, please specify both relation, and type of cancer:
    </div>
    <div class="span9">
        <%= j.text_area :cancerinfamilyspec, :cols => "30", :rows => "7" %>
    </div>
  </div>
  <div class="row-fluid">
    <div class="span3">
        <p>Previous surgical procedures</p>
    </div>
    <div class="span2">
        <%= j.select :prevsurgicalprocedures, options_from_collection_for_select(NoYes.all, :id,:noyes_combo, @journal.prevsurgicalprocedures), {}, {"ng-model" => "journal.prevsurgicalprocedures"}%> 
    </div>
  </div>
  <div class="row-fluid" ng-show="journal.prevsurgicalprocedures=='2'">
    <div class="span3">
        <p>If yes, please specify*:
    </div>
    <div class="span9">
        <%= j.text_area :prevsurgicalproceduresspec, :cols => "30", :rows => "7" %>
    </div>
  </div>
  <div class="row-fluid" ng-show="journal.prevsurgicalprocedures=='2'">
    <div class="span4 offset3">
      <p class="infoSmall">*See instructions for examples</p>
    </div>
  </div>
  <div class="row-fluid">
    <div class="span3">
        <p>Previous radiation therapy</p>
    </div>
    <div class="span2">
        <%= j.select :prevradtherapy, options_from_collection_for_select(NoYes.all, :id,:noyes_combo, @journal.prevradtherapy), {}, {"ng-model" => "journal.prevradtherapy"}%> 
    </div>
  </div>
  <div class="row-fluid" ng-show="journal.prevradtherapy=='2'">
    <div class="span3">
        <p>If yes, specify (for what, when, where and dose):
    </div>
    <div class="span9">
        <%= j.text_area :prevradtherapyspec, :cols => "30", :rows => "7" %>
    </div>
  </div>
  <h1 style="text-align:left;">First Primary Cancer</h1>
  <div class="row-fluid">
    <div class="span3">     
        <p><b>Diagnosis:</b></p><p class=infoSmall>(Please write the diagnosis as it is written in the medical record)</p>
    </div>
    <div class="span9">
        <%= j.text_area :firstprimcancerdiagnosis, :cols => "30", :rows => "7" %>
    </div>
  </div>
  <div class="row-fluid">
    <div class="span3">
        <p>Date of diagnosis*:</p>
    </div>
    <div class="span6">
        <%= j.date_select :dateofdiagnosis, :start_year => 1970, :end_year => Time.now.year, :default => @journal.dateofdiagnosis, :include_blank=> true, order: [:day, :month, :year] %>
    </div>
    <div class="span7 offset3">
        <p class="infoSmall">*Please see definition of the date of diagnosis in the instructions.</p>
    </div>
  </div>
  <div class="row-fluid">
    <div class="span4">
        <p>Please fill out the corresponding number for the first primary cancer type:</p>
    </div>
    <div class="span6">
      <br>
        <%= j.select :firstprimcancertype, options_from_collection_for_select(FirstPrimCancerType.all, :id,:firstprimcancertype_combo, @journal.firstprimcancertype), {}, {"ng-model" => "journal.firstprimcancertype"}%> 
    </div>
  </div>
  <div ng-show="journal.firstprimcancertype==1">
    <div class="row-fluid">
      <div class="span9">
        <h2 style=margin-bottom:0px;margin-top:20px;>1. Leukemia</h2><br>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
          <p>Subtype:</p>
      </div>
      <div class="span5">
          <%= j.select :leukemiasubtype, options_from_collection_for_select(LeukemiaSubType.all, :id,:leukemiasubtype_combo, @journal.leukemiasubtype), {}, {"ng-model" => "journal.leukemiasubtype"} %> 
      </div>
      <div class="span4">
        <p class=infoSmall> ALL = Acute Lymphoblastic Leukemia<br>
                            AML = Acute Myeloid Leukemia<br>
                            MDS = Myelodysplastic disorder<br>
                            CML = Chronic Myelocytic Leukemia<br>
                            JMML = Juvenile Myelomonocytic Leukemia</p>
      </div>
    </div>
  </div>
  <div ng-show="journal.firstprimcancertype==2">
    <div class="row-fluid">
      <div class="span9">
        <h2 style=margin-bottom:0px;margin-top:20px;>2. Hodgkin Lymphoma (HL, Hodgkin disease, HD)</h2><br>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
          <p>Subtype:</p>
      </div>
      <div class="span5">
          <%= j.select :hodgkinlymphomasubtype, options_from_collection_for_select(HodgkinLymphomaSubType.all, :id,:hodgkinlymphomasubtype_combo, @journal.hodgkinlymphomasubtype), {}, {"ng-model" => "journal.hodgkinlymphomasubtype"} %> 
      </div>
    </div>
    <div class="row-fluid">
      <div class="span9 offset3"
        <p class=infoSmall>*Other e.g. primary mediastinal lymphoma, follicular lymphoma, nodular marginal zone lymphoma, peripheral T-cell.</p>
      </div>
    </div>
  </div>
  <div ng-show="journal.firstprimcancertype=='3'">
    <div class="row-fluid">
      <div class="span9">
        <h2 style=margin-bottom:0px;margin-top:20px;>3. Non-Hodgkin Lymphoma (NHL)</h2><br>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
          <p>Subtype:</p>
      </div>
      <div class="span8">
          <%= j.select :nonhodgkinlymphomasubtype, options_from_collection_for_select(NonHodgkinLymphomaSubType.all, :id,:nonhodgkinlymphomasubtype_combo, @journal.nonhodgkinlymphomasubtype), {}, {"ng-model" => "journal.nonhodgkinlymphomasubtype"} %> 
      </div>
    </div>
    <div class="row-fluid">
      <div class="span9 offset3"
        <p class=infoSmall>*Other e.g. primary mediastinal lymphoma, follicular lymphoma, nodular marginal zone lymphoma, peripheral T-cell.</p>
      </div>
    </div>
  </div>
  <div ng-show="journal.firstprimcancertype=='4'">
    <div class="row-fluid">
      <div class="span9">
        <h2 style=margin-bottom:0px;margin-top:20px;>4. CNS tumor</h2><br>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
          <p>Histological type:</p>
      </div>
      <div class="span7">
          <%= j.select :cnstumorhistologicaltype, options_from_collection_for_select(CnsTumorHistologicalType.all, :id,:cnstumorhistologicaltype_combo, @journal.cnstumorhistologicaltype), {}, {"ng-model" => "journal.cnstumorhistologicaltype"} %> 
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
          <p>Primary tumor site:</p>
      </div>
      <div class="span6">
          <%= j.select :cnstumorprimarytumorsite, options_from_collection_for_select(CnsTumorPrimaryTumorSite.all, :id,:cnstumorprimarytumorsite_combo, @journal.cnstumorprimarytumorsite), {}, {"ng-model" => "journal.cnstumorprimarytumorsite"} %> 
      </div>
    </div>
    <div class="row-fluid" ng-show="journal.cnstumorprimarytumorsite=='20'">
      <div class="span3 offset3">
          <p>Please specify*:</p>
          <p class=infoBoxRed><i>Please note that <b>Germinomas</b> in the CNS are <b>listed in group 12</b> (Germ cell and other gonadal tumors)</i></p>
      </div>
      <div class="span6">
          <%= j.text_area :cnstumorprimarytumorsiteotherspec, :cols => "30", :rows => "7" %>
      </div>
    </div>
      <div class="row-fluid">
      <div class="span3">
          <p>Laterality:</p>
      </div>
      <div class="span4">
          <%= j.select :cnstumorlaterality, options_from_collection_for_select(LateralityRlbmn.all, :id,:lateralityrlbmn_combo, @journal.cnstumorlaterality), {}, {"ng-model" => "journal.cnstumorlaterality"} %> 
      </div>
    </div>
    <div class="row-fluid">
      <div class="span9 offset3">
        <p class=infoBox><i><u>Do not confuse:</u> PNET = <b>Primitive</b> neuroectodermal tumor with PNET = <b>Peripheral</b> neuroectodermal tumor which is a Ewing sarcoma or belongs to Ewing family of tumors.</i></p>
      </div>
    </div>
  </div>
  <div ng-show="journal.firstprimcancertype=='5'">
    <div class="row-fluid">
      <div class="span9">
        <h2 style=margin-bottom:0px;margin-top:20px;>5. Neuroblastoma (Sympathetic nervous system tumor)</h2><br>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
          <p>Primary tumor site:</p>
      </div>
      <div class="span4">
          <%= j.select :neuroblastomaprimarytumorsite, options_from_collection_for_select(NeuroblastomaPrimaryTumorSite.all, :id,:neuroblastomaprimarytumorsite_combo, @journal.neuroblastomaprimarytumorsite), {}, {"ng-model" => "journal.neuroblastomaprimarytumorsite"} %> 
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
          <p>Laterality:</p>
      </div>
      <div class="span4">
          <%= j.select :neuroblastomalaterality, options_from_collection_for_select(LateralityRlbn.all, :id,:lateralityrlbn_combo, @journal.neuroblastomalaterality), {}, {"ng-model" => "journal.neuroblastomalaterality"} %> 
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
          <p>Metastasis at diagnosis:</p>
      </div>
      <div class="span4">
          <%= j.select :neuroblastomametastasisatdiagnosis, options_from_collection_for_select(NoYesUnknownNotInv.all, :id,:noyesunknownnotinv_combo, @journal.neuroblastomametastasisatdiagnosis), {}, {"ng-model" => "journal.neuroblastomametastasisatdiagnosis"} %> 
      </div>
    </div>
  </div>
  <div ng-show="journal.firstprimcancertype=='6'">
    <div class="row-fluid">
      <div class="span9">
        <h2 style=margin-bottom:0px;margin-top:20px;>6. Renal tumor</h2><br>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
          <p>Tumor type:</p>
      </div>
      <div class="span4">
          <%= j.select :renaltumortype, options_from_collection_for_select(RenalTumorType.all, :id,:renaltumortype_combo, @journal.renaltumortype), {}, {"ng-model" => "journal.renaltumortype"} %> 
      </div>
    </div>
    <div class="row-fluid" ng-show="journal.renaltumortype=='4'">
      <div class="span3 offset3">
          <p>Please specify:</p>
      </div>
      <div class="span6">
          <%= j.text_area :renaltumortypeotherspec, :cols => "30", :rows => "7" %>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
          <p>Laterality:</p>
      </div>
      <div class="span4">
          <%= j.select :renaltumorlaterality, options_from_collection_for_select(LateralityRlbu.all, :id,:lateralityrlbu_combo, @journal.renaltumorlaterality), {}, {"ng-model" => "journal.renaltumorlaterality"} %> 
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
          <p>Metastasis at diagnosis:</p>
      </div>
      <div class="span4">
          <%= j.select :renaltumormetastasisatdiagnosis, options_from_collection_for_select(NoYesUnknownNotInv.all, :id,:noyesunknownnotinv_combo, @journal.renaltumormetastasisatdiagnosis), {}, {"ng-model" => "journal.renaltumormetastasisatdiagnosis"} %> 
      </div>
    </div>
  </div>
  <div ng-show="journal.firstprimcancertype=='7'">
    <div class="row-fluid">
      <div class="span9">
        <h2 style=margin-bottom:0px;margin-top:20px;>7. Malignant bone tumor</h2><br>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
          <p>Tumor type:</p>
      </div>
      <div class="span3">
          <%= j.select :malignantbonetumortype, options_from_collection_for_select(MalignantBoneTumorType.all, :id,:malignantbonetumortype_combo, @journal.malignantbonetumortype), {}, {"ng-model" => "journal.malignantbonetumortype"} %> 
      </div>
      <div class="span6">
          <p class=infoBox>*PNET = <b>Peripheral</b> neuroectodermal tumor, belong to Ewing sarcoma family of tumors, including Askin tumor and Ewing sarcoma soft-tissue.</p>
      </div>
    </div>
    <div class="row-fluid" ng-show="journal.malignantbonetumortype =='3'">
      <div class="span3 offset3">
          <p>Please specify:</p>
      </div>
      <div class="span6">
          <%= j.text_area :malignantbonetumortypeotherspec, :cols => "30", :rows => "7" %>
      </div>
    </div>
    <br>
    <div class="row-fluid">
      <div class="span3">
          <p>Laterality:</p>
      </div>
      <div class="span4">
          <%= j.select :malignantbonetumorlaterality, options_from_collection_for_select(LateralityRlbmu.all, :id,:lateralityrlbmu_combo, @journal.malignantbonetumorlaterality), {}, {"ng-model" => "journal.malignantbonetumorlaterality"} %> 
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
          <p>Metastasis at diagnosis:</p>
      </div>
      <div class="span4">
          <%= j.select :malignantbonetumormetastasisatdiagnosis, options_from_collection_for_select(NoYesUnknownNotInv.all, :id,:noyesunknownnotinv_combo, @journal.malignantbonetumormetastasisatdiagnosis), {}, {"ng-model" => "journal.malignantbonetumormetastasisatdiagnosis"} %> 
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
          <p>Primary tumor site:</p>
      </div>
      <div class="span8">
          <%= j.select :malignantbonetumorprimarytumorsite, options_from_collection_for_select(MalignantBoneTumorPrimaryTumorSite.all, :id,:malignantbonetumorprimarytumorsite_combo, @journal.malignantbonetumorprimarytumorsite), {}, {"ng-model" => "journal.malignantbonetumorprimarytumorsite"} %> 
      </div>
    </div>
    <div class="row-fluid" ng-show="journal.malignantbonetumorprimarytumorsite =='11'">
      <div class="span3 offset3">
          <p>Please specify:</p>
      </div>
      <div class="span6">
          <%= j.text_area :malignantbonetumorprimarytumorsiteotherspec, :cols => "30", :rows => "7" %>
      </div>
    </div>
  </div>
  <div ng-show="journal.firstprimcancertype=='8'">
    <div class="row-fluid">
      <div class="span9">
        <h2 style=margin-bottom:0px;margin-top:20px;>8. Soft tissue sarcomas*</h2><br>
      </div>
    </div>
    <div class="row-fluid" ng-show="journal.firstprimcancertype=='8'">
      <div class="span6">
        <p class=infoBox>*Soft-tissue sarcomas <b>not</b> including Ewing sarcoma</p>
      </div>
    </div>
    <br>
    <div class="row-fluid" ng-show="journal.firstprimcancertype=='8'">
      <div class="span3">
        <p>Tumor type:</p>
      </div>
      <div class="span5">
        <%= j.select :softtissuesarcomastumortype, options_from_collection_for_select(SoftTissueSarcomasTumorType.all, :id,:softtissuesarcomastumortype_combo, @journal.softtissuesarcomastumortype), {}, {"ng-model" => "journal.softtissuesarcomastumortype"} %>
      </div>
    </div>
    <div class="row-fluid" ng-show="journal.softtissuesarcomastumortype=='6'">
      <div class="span3 offset3">
          <p>Please specify:</p>
      </div>
      <div class="span6">
          <%= j.text_area :malignantbonetumorprimarytumorsiteotherspec, :cols => "30", :rows => "7" %>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
        <p>Laterality:</p>
      </div>
      <div class="span4">
        <%= j.select :softtissuesarcomaslaterality, options_from_collection_for_select(LateralityRlbu.all, :id,:lateralityrlbu_combo, @journal.softtissuesarcomaslaterality), {}, {"ng-model" => "journal.softtissuesarcomaslaterality"} %>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
        <p>Primary tumor site:</p>
      </div>
      <div class="span4">
        <%= j.select :softtissuesarcomasprimarytumorsite, options_from_collection_for_select(SoftTissueSarcomasPrimaryTumorSite.all, :id,:softtissuesarcomasprimarytumorsite_combo, @journal.softtissuesarcomasprimarytumorsite), {}, {"ng-model" => "journal.softtissuesarcomasprimarytumorsite"} %>
      </div>
    </div>
  </div>
  <div ng-show="journal.softtissuesarcomasprimarytumorsite=='9'">
      <div class="row-fluid">
        <div class="span3 offset3">
            <p>Please specify:</p>
        </div>
        <div class="span6">
            <%= j.text_area :softtissuesarcomasprimarytumorsiteotherspec, :cols => "30", :rows => "7" %>
        </div>
      </div>
      <div class="row-fluid">
        <div class="span3">
          <p>Metastasis at diagnosis:</p>
        </div>
        <div class="span4">
          <%= j.select :softtissuesarcomasmetastasisatdiagnosis, options_from_collection_for_select(NoYesUnknownNotInv.all, :id,:noyesunknownnotinv_combo, @journal.softtissuesarcomasmetastasisatdiagnosis), {}, {"ng-model" => "journal.softtissuesarcomasmetastasisatdiagnosis"} %>
        </div>
      </div>
    </div>
    <div ng-show="journal.firstprimcancertype=='9'">
      <div class="row-fluid">
        <div class="span4">
          <h2>9. Retinoblastoma</h2>
          <p>Laterality</p>
          <%= j.select :retinoblastomalaterality, options_from_collection_for_select(LateralityRlbu.all, :id,:lateralityrlbu_combo, @journal.retinoblastomalaterality), {}, {"ng-model" => "journal.retinoblastomalaterality"} %>
        </div>
      </div>
  </div>
  <div ng-show="journal.firstprimcancertype=='10'">
    <div class="row-fluid">
      <div class="span4">
        <h2>10. Hepatic tumor</h2>
        <p>Tumor type</p>
        <%= j.select :hepatictumortype, options_from_collection_for_select(HepaticTumorType.all, :id,:hepatictumortype_combo, @journal.hepatictumortype), {}, {"ng-model" => "journal.hepatictumortype"} %>
      </div>
    </div>
  </div>
  <div ng-show="journal.firstprimcancertype=='11'">
    <div class="row-fluid">
      <h2>11. Carcinomas</h2>
    </div>
    <div class="row-fluid">
      <div class="span4">
        <p>Tumor type</p>
        <%= j.select :carcinomastumortype, options_from_collection_for_select(CarcinomasTumorType.all, :id,:carcinomastumortype_combo, @journal.carcinomastumortype), {}, {"ng-model" => "journal.carcinomastumortype"} %>
        <%= j.text_area :carcinomastumortypeotherspec, :cols => "20", :rows => "1", "ng-show" => "journal.carcinomastumortype" %>
      </div>
      <div class="span3">
        <p>Laterality</p>
        <%= j.select :carcinomaslaterality, options_from_collection_for_select(LateralityRlbn.all, :id,:lateralityrlbn_combo, @journal.carcinomaslaterality), {}, {"ng-model" => "journal.carcinomaslaterality"} %>
      </div>
      <div class="span4">
        <p>Metastasis at diagnosis</p>
        <%= j.select :carcinomasmetastasisatdiagnosis, options_from_collection_for_select(NoYesUnknownNotInv.all, :id,:noyesunknownnotinv_combo, @journal.carcinomasmetastasisatdiagnosis), {}, {"ng-model" => "journal.carcinomasmetastasisatdiagnosis"} %>
      </div>
    </div>
  </div>
  <div ng-show="journal.firstprimcancertype=='12'">
    <div class="row-fluid">
      <h2>12. Germ cell and gonadal tumors</h2>
      <p>GCT = Germ cell tumor</p>
    </div>
    <div class="row-fluid">
      <div class="span4">
        <p>Tumor type</p>
        <%= j.select :germcelltumorsandgonadalstumorstype, options_from_collection_for_select(GermCellTumorsAndGonadalsTumorType.all, :id,:germcelltumorsandgonadalstumorstype_combo, @journal.germcelltumorsandgonadalstumorstype), {}, {"ng-model" => "journal.germcelltumorsandgonadalstumorstype"} %>
      </div>
      <div class="span3">
        <p>Laterality</p>
        <%= j.select :germcelltumorsandgonadaltumorslaterality, options_from_collection_for_select(LateralityRlbmn.all, :id,:lateralityrlbmn_combo, @journal.germcelltumorsandgonadaltumorslaterality), {}, {"ng-model" => "journal.germcelltumorsandgonadaltumorslaterality"} %>
      </div>
      <div class="span4">
        <p>Metastasis at diagnosis</p>
        <%= j.select :germcellandgonadalstumorsmetastasisatdiagnosis, options_from_collection_for_select(NoYesUnknownNotInv.all, :id,:noyesunknownnotinv_combo, @journal.germcellandgonadalstumorsmetastasisatdiagnosis), {}, {"ng-model" => "journal.germcellandgonadalstumorsmetastasisatdiagnosis"} %>
      </div>
    </div>
  </div>
  <div ng-show="journal.firstprimcancertype=='13'">
    <div class="row-fluid">
      <h2>13. Other</h2>
    </div>
    <div class="row-fluid">
      <div class="span5">
        <p>Tumor type</p>
        <%= j.select :othertumortype, options_from_collection_for_select(OtherTumorType.all, :id,:othertumortype_combo, @journal.othertumortype), {}, {"ng-model" => "journal.othertumortype"} %>
        <%= j.text_area :othertumortypeotherspec, :cols => "20", :rows => "1", "ng-show" => "journal.othertumortype == '2'" %>
      </div>
      <div class="span5 offset1">
        <p>Primary tumor site</p>
        <%= j.select :otherprimarytumorsite, options_from_collection_for_select(OtherPrimaryTumorSite.all, :id,:otherprimarytumorsite_combo, @journal.otherprimarytumorsite), {}, {"ng-model" => "journal.otherprimarytumorsite"} %>
        <%= j.text_area :otherprimarytumorsiteotherspec, :cols => "20", :rows => "1", "ng-show" =>"journal.otherprimarytumorsite == '9'" %>
      </div>
    </div>
  </div>
  <br><br>
  <div class="row-fluid">
    <div class="span3">
      <h2>Radiotherapy</h2>
    </div>
    <div style="margin-top:10px;"class="span2">
      <%= j.select :radiotherapy, options_from_collection_for_select(NoYesUnknown.all, :id,:noyesunknown_combo, @journal.radiotherapy), {}, {"ng-model" => "journal.radiotherapy"} %> 
    </div>
  </div>
<!--Allt sem tilheyrir radiotherapy bara birt ef Yes í Radiotherapy-->  
  <div ng-show="journal.radiotherapy == '2'">
    <div class="row-fluid">
      <div class="span3">
          <p><b>External beam radiotherapy:</b></p>
      </div>
      <div class="span2">
        <%= j.select :externalbeamradiotherapy, options_from_collection_for_select(NoYes.all, :id,:noyes_combo, @journal.externalbeamradiotherapy), {}, {"ng-model" => "journal.externalbeamreadiotherapy"} %> 
      </div>
    </div>
  <!--Allt sem tilheyrir External beam radiotherapy birtist ef Yes í því comboi-->
    <div ng-show="journal.externalbeamreadiotherapy == '2'">
      <div class="row-fluid">
        <div class="span3">
          <p>Date of start:</p>
        </div>
        <div class="span6">
          <%= j.date_select :externalbeamradiotherapydateofstart, :start_year => 1970, :end_year => Time.now.year, :default => @journal.externalbeamradiotherapydateofstart, :include_blank=> true, order: [:day, :month, :year] %>
        </div>
      </div>
      <div class="row-fluid">
        <div class="span3">
          <p>Date of completion:</p>
        </div>
        <div class="span6">
          <%= j.date_select :externalbeamradiotherapydateofcompletion, :start_year => 1970, :end_year => Time.now.year, :default => @journal.externalbeamradiotherapydateofcompletion, :include_blank=> true, order: [:day, :month, :year] %>
        </div>
      </div>
      <div class="row-fluid">
        <div class="span3">
            <p>Treating hospital(-s) and department, radiotherapy:</p>
        </div>
        <div class="span9">
            <%= j.text_area :externalbeamradiotherapytreatinghospital, :cols => "30", :rows => "7" %>
        </div>
      </div>
      <div class="row-fluid">
        <div class="span4">
          <p class="infoSmallRed">Radiotherapy records AND relevant text in the medical record copied*:</p>
        </div>
        <div class="span6" style=margin-top:5px;>
          <%= j.date_select :externalbeamradiotherapyrecordscopied, :start_year => 1970, :end_year => Time.now.year, :default => @journal.externalbeamradiotherapyrecordscopied, :include_blank=> true, order: [:day, :month, :year] %>
        </div>
      </div>
      <div class="row-fluid">
        <div class="span6 offset4">
          <p class="infoSmall" style=margin-top:-15px;>*copied WITHOUT any personal identifications, only including a front page (e.g. with the ALiCCS study number).</p>
        </div>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
          <p><b>Brachytherapy:</b></p>
      </div>
      <div class="span2">
        <%= j.select :brachytherapy, options_from_collection_for_select(NoYes.all, :id,:noyes_combo, @journal.brachytherapy), {}, {"ng-model" => "journal.brachytherapy"} %>
      </div>
    </div>
  <!--Allt sem tilheyrir Brachytherapy birtist ef Yes í því comboi-->
    <div ng-show="journal.brachytherapy == '2'">
      <div class="row-fluid">
        <div class="span3">
          <p>Date of start:</p>
        </div>
        <div class="span6">
          <%= j.date_select :brachytherapydateofstart, :start_year => 1970, :end_year => Time.now.year, :default => @journal.brachytherapydateofstart, :include_blank=> true, order: [:day, :month, :year] %>
        </div>
      </div>
      <div class="row-fluid">
        <div class="span3">
          <p>Date of completion:</p>
        </div>
        <div class="span6">
          <%= j.date_select :brachytherapydateofcompletion, :start_year => 1970, :end_year => Time.now.year, :default => @journal.brachytherapydateofcompletion, :include_blank=> true, order: [:day, :month, :year] %>
        </div>
      </div>
      <div class="row-fluid">
        <div class="span3">
            <p>Treating hospital(-s) and department, radiotherapy:</p>
        </div>
        <div class="span9">
            <%= j.text_area :brachytherapytreatinghospital, :cols => "30", :rows => "7" %>
        </div>
      </div>
      <div class="row-fluid">
        <div class="span4">
          <p class="infoSmallRed">Radiotherapy records AND relevant text in the medical record copied*:</p>
        </div>
        <div class="span6" style=margin-top:5px;>
          <%= j.date_select :brachytherapyrecordscopied, :start_year => 1970, :end_year => Time.now.year, :default => @journal.brachytherapyrecordscopied, :include_blank=> true, order: [:day, :month, :year] %>
        </div>
      </div>
      <div class="row-fluid">
        <div class="span6 offset4">
          <p class="infoSmall" style=margin-top:-15px;>*copied WITHOUT any personal identifications, only including a front page (e.g. with the ALiCCS study number).</p>
        </div>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
          <p><b>Internal (metabolic) radiotherapy:</b></p>
      </div>
      <div class="span2">
        <%= j.select :internalradiotherapy, options_from_collection_for_select(NoYes.all, :id,:noyes_combo, @journal.internalradiotherapy), {}, {"ng-model" => "journal.internalradiotherapy"} %> 
      </div>
    </div>
  <!--Allt sem tilheyrir Internal radiotherapy birtist ef Yes í því comboi-->
    <div ng-show="journal.internalradiotherapy == '2'">
      <div class="row-fluid">
        <div class="span3">
          <p>Date of start:</p>
        </div>
        <div class="span6">
          <%= j.date_select :internalradiotherapydateofstart, :start_year => 1970, :end_year => Time.now.year, :default => @journal.internalradiotherapydateofstart, :include_blank=> true, order: [:day, :month, :year] %>
        </div>
      </div>
      <div class="row-fluid">
        <div class="span3">
            <p>Treating hospital(-s) and department, radiotherapy:</p>
        </div>
        <div class="span9">
            <%= j.text_area :internalradiotherapytreatinghospital, :cols => "30", :rows => "7" %>
        </div>
      </div>
      <div class="row-fluid">
        <div class="span4">
          <p class="infoSmallRed">Radiotherapy records AND relevant text in the medical record copied*:</p>
        </div>
        <div class="span6" style=margin-top:5px;>
          <%= j.date_select :internalradiotherapyrecordscopied, :start_year => 1970, :end_year => Time.now.year, :default => @journal.internalradiotherapyrecordscopied, :include_blank=> true, order: [:day, :month, :year] %>
        </div>
      </div>
      <div class="row-fluid">
        <div class="span6 offset4">
          <p class="infoSmall" style=margin-top:-15px;>*copied WITHOUT any personal identifications, only including a front page (e.g. with the ALiCCS study number).</p>
        </div>
      </div>
    </div>
  </div>
  <div class="row-fluid">
    <div class="span3">
        <h2><b>Surgery</b></h2>
    </div>
    <div class="span2" style="margin-top:10px;">
      <%= j.select :surgery, options_from_collection_for_select(NoYes.all, :id,:noyes_combo, @journal.surgery), {}, {"ng-model" => "journal.surgery"} %> 
    </div>
  </div>
  <!--Allt sem tilheyrir Surgery birtist ef Yes í því comboi-->
  <%= j.fields_for :surgeries do |builder| %>
    <%= render 'surgery_fields', f: builder %>
  <% end %>
  <div ng-show="journal.surgery=='2'">
    <p class="infoSmall">Please click "Add surgery" for each surgery and fill in the information.</p>
  <%= link_to_add_fields "Add surgery", j, :surgeries %>
  </div>
  <br><br>
  <div class="row-fluid">
    <div class="span3">
        <h2><b>Chemotherapy</b></h2>
    </div>
    <div class="span2" style="margin-top:10px;">
      <%= j.select :chemotherapy, options_from_collection_for_select(NoYes.all, :id,:noyes_combo, @journal.chemotherapy), {}, {"ng-model" => "journal.chemotherapy"} %> 
    </div>
  </div>
  <div class="row-fluid">
    <div class="span7 offset3" style="margin-top:-15px;">
      <p class="infoSmall">and other relevant drugs (see instructions and drug codes in Appendix I)</p>
    </div>
  </div>
  <div ng-show="journal.chemotherapy=='2'">
    <div class="row-fluid">
      <div class="span3">
        <p>Date of initiation of chemotherapy:</p>
      </div>
      <div class="span6" style="margin-top:10px;">
        <%= j.date_select :chemotherapydateinitiation, :start_year => 1970, :end_year => Time.now.year, :default => @journal.chemotherapydateinitiation, :include_blank=> true, order: [:day, :month, :year] %>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
        <p>Date of all chemotherapy completed:</p>
      </div>
      <div class="span6">
        <%= j.date_select :chemotherapydatecompletion, :start_year => 1970, :end_year => Time.now.year, :default => @journal.chemotherapydatecompletion, :include_blank=> true, order: [:day, :month, :year] %>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
        <p>Body surface (m<sup>2</sup>) <b>at diagnosis</b>:</p>
      </div>
      <div class="span2">
        <%= j.number_field :chemotherapybodysurfaceatdiagnosis, {step: 0.01, min: 0} %>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
        <p>Weight (kg):</p>
      </div>
      <div class="span2">
        <%= j.number_field :chemotherapyweightatdiagnosis, {step: 0.1, min: 0} %>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
        <p>Height (cm):</p>
      </div>
      <div class="span2">
        <%= j.number_field :chemotherapyheightatdiagnosis, {step: 0.1, min: 0} %>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
          <p>Was body surface estimated?</p>
      </div>
      <div class="span2">
          <%= j.select :chemotherapyestimated, options_from_collection_for_select(NoYes.all, :id,:noyes_combo), :include_blank => true %> 
      </div>
    </div>
      <%= j.fields_for :chemo_therapies do |builder| %>
        <%= render 'chemo_therapy_fields', f: builder %>
      <% end %>
      <p class="infoSmallRed">If cancer treatment extends through out more than one year please click "Add chemotherapy year" for each year and give a <b>yearly body surface</b> (m<sup>2</sup>)</p>
      <%= link_to_add_fields "Add chemotherapy year", j, :chemo_therapies %>
    <br><br>
    <table class="span12" style="position:relative;left:-55px">
      <thead>
        <th style="width:260px">Cytostatic drug (code - name)</th>
        <th style="width:200px">Total cumulated dose<br>(mg/m<sup>2</sup> or units/m<sup>2</sup>)</th>
        <th style="width:110px">Dose quality</th>
        <th style="width:260px">Anthracyclines: bolus vs. inf**</th>
        <th></th>
      </thead>
      <tbody>
    <%= j.fields_for :cytostatic_drug_given do |builder| %>
      <%= render 'cytostatic_drug_given_fields', f: builder %>
    <% end %>
      </tbody>
    </table>

    <%= link_to_add_fields "Add cytostatic drug given", j, :cytostatic_drug_given %>
    <div class="row-fluid">
      <div class="span12">
        <p class=infoBox><b>In case of anthracycline use:</b><br>**Please give the average rate of administration for the <b>majority</b> of anthracycline doses given.<br>Anthracyclines: <b>doxorubicin</b>, Adriamycin&reg;, Adria&reg;; <b>daunorubicin</b>, Daunomycin&reg;, Cerubidine&reg;; <b>idarubicin</b>, Idamycin&reg;; mitoxantrone, Novantrone&reg;; <b>epirubicine</b><br>
        </p>
      </div>
      <div class="span3">
        <p>Were cardioprotectants used?</p>
      </div>
      <div class="span2">
        <%= j.select :chemocardioprotectants, options_from_collection_for_select(NoYes.all, :id,:noyes_combo), {}, {"ng-model" => "journal.chemocardioprotectants"} %>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span8 offset3">
        <p class="infosmall" style="margin-top:-15px;">Cardioprotectants: Cardioxane, Zinecard or DexrazOxane</p>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span4">
        <p><b>Treatment protocol (if applicable):</b></p>
        <p class="infoSmall" style="margin-top:-10px;">If the patient is treated (more or less) according to a protocol, please write the name of the protocol.</p>
      </div>
      <div class="span8">
          <%= j.text_area :chemotherapytreatmentprotocolspec, :cols => "30", :rows => "3" %>
      </div>
    </div>
    <div class="row-fluid">
      <p><b>Central venous catheter (CVC)</b></p>
    </div>
    <div class="row-fluid">
      <div class="span3">
        <p>CVC inserted?</p>
      </div>
      <div class="span2">
        <%= j.select :chemotherapyCVC, options_from_collection_for_select(NoYesUnknown.all, :id,:noyesunknown_combo, @journal.chemotherapyCVC), {}, {"ng-model" => "journal.chemotherapyCVC"} %> 
      </div>
    </div>
    <div ng-show="journal.chemotherapyCVC=='2'">
      <div class="row-fluid">
        <div class="span4">
          <p>If yes, how many in total were inserted during the treatment period?</p>
        </div>
        <div class="span2">
          <!--Athuga-->
        </div>
      </div>
      <div class="row-fluid">
        <div class="span3">
          <p>Date (month and year) of insertion of the first CVC:</p>
        </div>
        <div class="span6" style="margin-top:10px;">
          <%= j.date_select :chemotherapyinsertiondatecvc, {:start_year => 1970, :end_year => Time.now.year, :default => @journal.chemotherapyinsertiondatecvc, :include_blank=> true, order: [:month, :year]}, {:class => "date_generic"}  %>
        </div>
      </div>
      <div class="row-fluid">
        <div class="span3">
          <p>Date of permanent removal:</p>
        </div>
        <div class="span6" style="margin-top:10px;">
          <%= j.date_select :chemotherapypermanentremovaldate, {:start_year => 1970, :end_year => Time.now.year, :default => @journal.chemotherapypermanentremovaldate, :include_blank=> true, order: [:month, :year]}, {:class => "date_generic"}  %>
        </div>
      </div>
    </div>  
  </div>
  <div class="row-fluid">
    <div class="span4">
        <h2><b>Bone marrow transplantation</b></h2><p class="infoSmall" style="margin-top:-20px;">(BMT, Stem cell transplant, SCT)</p>
    </div>
    <div class="span2" style="margin-top:10px;">
      <%= j.select :bonemarrowtransplantation, options_from_collection_for_select(NoYes.all, :id,:noyes_combo, @journal.bonemarrowtransplantation), {}, {"ng-model" => "journal.bonemarrowtransplantation"} %> 
    </div>
  </div>
  <%= j.fields_for :bone_marrow_transplantations do |builder| %>
  <%= render 'bone_marrow_transplantation_fields', f: builder %>
  <% end %>
  <div ng-show="journal.bonemarrowtransplantation == '2'">
  <%= link_to_add_fields "Add bone marrow transplantation", j, :bone_marrow_transplantations %>
  </div>
  <div class="row-fluid">
    <div class="span4">
        <h2><b>Relapse / Recurrent disease</b></h2>
    </div>
    <div class="span2" style="margin-top:10px;">
      <%= j.select :relapse, options_from_collection_for_select(NoYes.all, :id,:noyes_combo), {}, {"ng-model" => "journal.relapse"}%> 
    </div>
  </div>
  <div ng-show="journal.relapse=='2'">
    <div class="row-fluid">
      <div class="span8 offset4" style="margin-top:-15px;">
        <p class="infoSmallRed">If yes, please fill out an other treatment form for each relapse/recurrence.</p>
      </div>
    </div>
    <div class='row-fluid'>
    <%= j.fields_for :relapses do |builder, index| %>
      <%= render 'relapse_fields', f: builder %>
    <% end %>
    <%= link_to_add_fields "Add relapse", j, :relapses %>
    </div>
    <div class="row-fluid">
      <div class="span4">Remission status (according to med. records):</div>
      <div class="span4">
        <%= j.select :remissionstatus, options_from_collection_for_select(RemissionStatus.all, :id, :combo), {}, {"ng-model" => "journal.remissionstatus"} %>
      </div>
    </div>
  </div>  
  <div class="row-fluid">
    <div class="span4">
        <h2><b>After the cancer treatment</b></h2>
    </div>
  </div>
  <div class="row-fluid">
    <div class="span3">
      <p>Date of last doctors visit:</p>
    </div>
    <div class="span6">
      <%= j.date_select :lastdoctorsvisitdate, {:start_year => 1970, :end_year => Time.now.year, :default => @journal.lastdoctorsvisitdate, :include_blank=> true, order: [:day, :month, :year]}, {:class => "date_generic"}  %>
    </div>
  </div>
  <div class="row-fluid">
    <div class="span3">
      <p>Status at last doctor visit:</p>
    </div>
    <div class="span6">
      <%= j.select :lastdoctorsvisitstatus, options_from_collection_for_select(LastDoctorsVisitStatus.all, :id,:lastdoctorsvisitstatus_combo,@journal.lastdoctorsvisitstatus), {}, {"ng-model" => "journal.lastdoctorsvisitstatus"} %> 
    </div>
  </div>
  <!--Sýna ef ,,Permanent complications valið í combo fyrir ofan-->
  <div class="row-fluid" ng-show="journal.lastdoctorsvisitstatus == '2'">
    <div class="span3">
        <p>If permanent complications, please specify in free text and note any disabilities:</p>
    </div>
    <div class="span9">
        <%= j.text_area :permanentcomplicationspec, :cols => "30", :rows => "7" %>
    </div>
  </div>
















  <div align="center">
        <%= j.submit "Save changes", class: "btn btn-large btn-primary" %>
  </div>
      
      <% end %>
</div>